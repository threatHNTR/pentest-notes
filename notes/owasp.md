# Testing the Top 10 Web Application Vulnerabilities

## OWASP Top 10 Testing Checklist

OWASP Top 10: https://owasp.org/www-pdf-archive/OWASP_Top_10-2017_%28en%29.pdf.pdf

OWASP Testing Checklist: https://github.com/tanprathan/OWASP-Testing-Checklist

OWASP Testing Guide: https://owasp.org/www-project-web-security-testing-guide/assets/archive/OWASP_Testing_Guide_v4.pdf

## Installing OWASP Juice Shop

Before starting, ensure your Kali Linux is fully up to date.

Add Docker PGP key (saved to /usr/share/keyrings/):
```
curl -fsSL https://download.docker.com/linux/debian/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/docker-archive-keyring.gpg >/dev/null
```

Configure Docker APT repository (Kali is based on Debian testing, which will be called buster upon release, and Docker now has support for it):
```
echo 'deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian buster stable' | sudo tee /etc/apt/sources.list.d/docker.list
```

Update 
```
sudo apt-get update
```

If you had older versions of Docker installed, uninstall them:
```
sudo apt-get remove -y docker docker-engine docker.io
```

Install Docker:
```
sudo apt-get install -y docker-ce
```

Install JuiceShop
```
docker pull bkimminich/juice-shop
```
```
docker run --rm -p 3000:3000 bkimminich/juice-shop
```

Browse to http://localhost:3000

---
Juice Shop Gitbook

- https://juice-shop.github.io/juice-shop/#/

## SQL Injection Attacks

https://owasp.org/www-project-top-ten/2017/A1_2017-Injection.html

- SELECT - retieves data from a table
- INSERT - adds data to a table
- DELETE - removes data from table
- UPDATE - modifies data in a table
- DROP - deletes a table (very malicious)
- UNION - combines data from multiple queries
- WHERE
- AND/OR/NOT
- ORDER BY

Examples:

Input: test
SQL: SELECT * FROM Users WHERE email='test';

Input: test'
SQL: SELECT * FROM Users WHERE email='test'';

Input: test' OR 1=1; --
SQL: SELECT * FROM Users WHERE email='test' OR 1=1; --'

Input: test' (sleep 10)

## Broken Authentication

https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html

- Check Username Enumeration
- Forgot Password Check
- Check Session Fixation

## Sensitive Data Exposure

https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure.html

## XML External Entities (XXE)

https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE).html

https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20Injection

```
<?xml version="1.0" encoding="ISO-8859-1"?>
  <!DOCTYPE foo [  
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]><foo>&xxe;</foo>
```

## Broken Access Control

https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html

## Security Misconfiguration Attack

https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html

## Cross-Site Scripting (XSS)

OWASP A7-Cross Site Scripting: https://www.owasp.org/index.php/Top_10-2017_A7-Cross-Site_Scripting_(XSS)

DOM Based XSS: https://www.scip.ch/en/?labs.20171214

XSS Game: https://xss-game.appspot.com/

- Reflected
- Stored
- DOM

```
<?php
$username = $_GET['username']
echo "Hi $username!";
?>
```
```
index.php?username=Hunter
Hi Hunter!
```
```
index.php?username=<script>alert(1)</script>
```

## Insecure Deserialization

https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization.html

## Using Components with Known Vulnerabilities

https://www.owasp.org/index.php/Top_10-2017_A9-Using_Components_with_Known_Vulnerabilities

## Insufficient Logging and Monitoring

https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring.html
