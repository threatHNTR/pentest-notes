# Windows Privilege Escalation

Fuzzy Security Guide - https://www.fuzzysecurity.com/tutorials/16.html

PayloadsAllTheThings Guide - https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md

Absolomb Windows Privilege Escalation Guide - https://www.absolomb.com/2018-01-26-Windows-Privilege-Escalation-Guide/

Sushant 747's Guide (Country dependant - may need VPN) - https://sushant747.gitbooks.io/total-oscp-guide/content/privilege_escalation_windows.html

## Gaining a Foothold

msfvenom: https://netsec.ws/?p=331

## Initial Enumeration

### System Enumeration

```
systeminfo
systeminfo | findstr /B /C: "OS Name" /C:"OS Version" /C:"System Type"
```
```
hostname
```
```
wmic wfe
wmic wfe get Caption,Description,HotFixID,InstalledOn
```
```
wmic logicaldisk get caption,description,providername
```

### User Enumeration

```
whoami
whoami /priv
whoami /groups
```
```
net user
net user hunter
net user administrator
net localgroup
net localgroup administrators
```

## Network Enumeration

```
ipconfig
ipconfig /all
```
```
arp -a
arp -all
```
```
route print
```
```
netstat -ano
```

### Password Hunting

Search for them:

```
findstr /si password *.txt
findstr /si password *.xml
findstr /si password *.ini

#Find all those strings in config files.
dir /s *pass* == *cred* == *vnc* == *.config*

# Find all passwords in all files.
findstr /spin "password" *.*
findstr /spin "password" *.*
```

In Files:

```
c:\sysprep.inf
c:\sysprep\sysprep.xml
c:\unattend.xml
%WINDIR%\Panther\Unattend\Unattended.xml
%WINDIR%\Panther\Unattended.xml

dir c:\*vnc.ini /s /b
dir c:\*ultravnc.ini /s /b 
dir c:\ /s /b | findstr /si *vnc.ini
```

In Registry:

```
# VNC
reg query "HKCU\Software\ORL\WinVNC3\Password"

# Windows autologin
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon"

# SNMP Paramters
reg query "HKLM\SYSTEM\Current\ControlSet\Services\SNMP"

# Putty
reg query "HKCU\Software\SimonTatham\PuTTY\Sessions"

# Search for password in registry
reg query HKLM /f password /t REG_SZ /s
reg query HKCU /f password /t REG_SZ /s
```

### AV Enumeration

```
query windefend
```
```
sc queryex type= service
```
```
net advfirewall firewall dump
```
```
firewall show state
```
```
netsh fireall show config
```
