# SoSimple Writeup w/o Metasploit

**Author:** Hunter Juhan

**Date:** January 21st, 2024

So Simple is a beginner-level vulnerable box created by @roelvb79. It offers valuable insights into the world of penetration testing, with a focus on understanding public exploit techniques often encountered in OSCP-like virtual machines. In this walkthrough, we will guide you through the steps to successfully exploit this VM.

## Reconnaissance

To begin, we need to gather information about the target system. We used Nmap to discover open ports and services running on the target.

```
sudo nmap -T4 -p- -A -oA sosimple 192.168.178.78
```

* **-T4**: sets the timing template to level 4, which increases the scanning speed while being moderately aggressive
* **-p-**: scans all 65,535 TCP ports
* **-A**: enables aggressive scanning options, including script scanning, version detection, and OS detection
* **-oA**: output all formats and store in file _sosimple_

We get back the following result showing that 2 ports are open

- Port 22: OPenSSH 8.2p1
- Port 80: Apache httpd 2.4.41

![nmap](images/sosimple-nmap.png)

## Enumeration

I normally start with enumerating port 80.

Visit the application

(image here)

Letâ€™s do more enumeration on the web server. Run ffuf to enumerate directories.

```
ffuf -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt -u http://192.168.178.78/FUZZ
```

* **-w**: specifies the wordlist file to be used for fuzzing
* **-u**: specify the target URL for fuzzing

![ffuf](images/sosimple-ffuf.png)

Our next step was to find if there was a WordPress installation on the target. We used Wpscan to enumerate it.

```
wpscan --url http://192.168.178.78/wordpress/ --api-token * --enumerate p,u
```

* **--url**: specifies the target WordPress website's URL
* **--api-token**: provide an API token for authenticated scanning
* **--enumerate**: enumerate information related to plugins and users on the target WordPress site
 
While enumerating, we found a wp-admin panel and a user named "max." However, we didn't have the password, so we proceeded to bruteforce it.

```
wpscan --url http://192.168.178.78/wordpress/ --api-token * --enumerate u -P /usr/share/wordlists/rockyou.txt
```

* **--url**: specifies the target WordPress website's URL
* **--api-token**: provide an API token for authenticated scanning
* **--enumerate**: enumerate user accounts on the target WordPress site
* **-P**: specifies the path to a password list o perform a brute force attack on the WordPress site to gues passwords for the identified user accounts

During our exploration, we came across an unusual discovery: an outdated plugin named "Social Warfare." We made a note of this for later investigation.

![wordpress-vuln](images/sosimple-wpscan-vuln.png)

## Gaining a Foothold

Now that we had identified the vulnerable plugin, it was time to exploit it.

Exploiting RCE using Social Warfare plugin

- We followed the Proof of Concept (PoC) steps to leverage an RCE (Remote Code Execution) vulnerability in the "Social Warfare" plugin.
- We created a payload.txt file containing a code snippet and hosted it on our own Python server.
- Using a specific URL, we triggered the RCE vulnerability, executing our payload on the target system.

## Privilege Escalation

With initial access, we aimed to escalate privileges to gain more control.

Gaining Max's Account using SSH Key:

- We explored Max's account and discovered an SSH key with read permission.
- We copied this private key to our local system and connected to Max's SSH session.

Escalating to Steven using sudoers File:

- Our investigation led us to the sudoers file, which contained a binary allowing us to run services as another user, "steven."
- We leveraged this to escalate our privileges to Steven's account.

Escalating to Root using sudoers File:

- Further analysis of the sudoers file revealed another opportunity. We found a script that could run as root without requiring a password.
- To exploit this, we created a script and executed it as root, achieving a root shell.

## Lessons Learned
